# Assignment 3 - Cookie Management Vulnerability Scanner
A Web Application vulnerability scanner developed for CS5331 Assignment 3.
This application focuses on Cookie Management

### Requirements
- Get cookie of logged in user
- Should not raise any error that may alert user

### Categories covered
- Session Fixation
- Session Hijacking
- Predictable Cookies

### Usage
- Run setup.sh
- Run crawl.sh
- Run cookie_monster.py

## Dependencies
- Python
  - pip
  - Scrapy
    - Used as crawler
  - sqlalchemy
    - ORM to interact with sqlite3
- tshark
  - To capture network traffic
- Selenium
  - To control browser to perform logins
  - Might be possible to do without browser, but just https/http requests
- sqlite3
  - database to store crawled information

## Crawler
- Specify starting urls and allowed domains to crawl in benchmark_spider.py
- Crawler will crawl all links and write results into database
- Refer to schema below for the information scraped from each page
- To edit settings like obeying robots.txt, log levels, databse name, edit corresponding values in settings.py

Other functionalities
 - Identify forms within pages (login buttons, username, and password fields)

## Payload Generation

## Payload Injection

## Verification Script

## Database Schema
- urls
  - url (String, contains full url, primary key)
  - protocol (String, http or https)
  - domain (String, e.g. nuscomputing from www.freshmen.nuscomputing.com)
  - path (String, e.g. /2016/11/22/ from http://www.scrapingauthority.com/2016/11/22/scrapy-login/)
  - page (String, e.g. search from https://www.google.com/search?q=hi)
  - get_params (String, e.g. q=hi&a=b from https://www.google.com/search?q=hi&a=b)
  - scrape_date (DateTime, contains the date this item was added to table)

- forms
	- url (String, contains full url, primary key)
	- id_attr (String, contains the form's html id attribute, primary key)
	- scrape_date (DateTime, contains the date this item was added to table)

- inputs
	- input_id (Integer, generated by database, primary key)
	- url (String, url where input is found)
	- form_id (String, id attribute of form this input belong to)
	- complete (Stirng, the complete input tag, along with all attributes)
	- type_attr (String, the input's html type attribute)
	- scrape_date (DateTime, contains the date this item was added to table)
	- Foreign key url, form_id to forms.url and forms.id_attr